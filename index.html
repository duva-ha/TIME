<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giviso Neural Photos - 10A7</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background: #0f172a; color: white; overflow: hidden; height: 100vh; 
        }
        /* Style trục thời gian kiểu Google Photos */
        .photo-timeline-sidebar {
            position: fixed; right: 20px; top: 100px; bottom: 100px; width: 40px;
            display: flex; flex-direction: column; justify-content: space-between;
            align-items: center; z-index: 100; border-right: 1px solid rgba(255,255,255,0.1);
        }
        .time-mark { font-size: 10px; font-weight: 800; color: rgba(255,255,255,0.3); transform: rotate(-90deg); cursor: pointer; }
        .time-mark:hover { color: #3b82f6; }

        /* Container chứa mạng lưới */
        #network-container { width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; }

        /* Floating Headers như Google Photos */
        .date-floating-header {
            position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            padding: 8px 24px; border-radius: 40px; font-weight: 800; font-size: 12px;
            z-index: 50; border: 1px solid rgba(255,255,255,0.1); pointer-events: none;
        }

        .glass-ui { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); }
    </style>
</head>
<body>

    <header class="fixed top-0 left-0 right-0 p-6 flex justify-between items-center z-[100] bg-gradient-to-b from-slate-900 to-transparent">
        <div class="flex items-center gap-4">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/50">
                <i class="fa-solid fa-circle-nodes"></i>
            </div>
            <h1 class="text-xl font-extrabold tracking-tighter">GIVISO <span class="text-blue-500">10A7</span></h1>
        </div>
        <div class="flex gap-4">
            <input type="text" placeholder="Tìm kỷ niệm, sự kiện..." class="glass-ui px-6 py-2 rounded-full text-sm outline-none border-none w-64 focus:ring-2 ring-blue-500 transition-all">
            <button onclick="openModal()" class="bg-white text-black px-6 py-2 rounded-full font-bold text-sm hover:bg-blue-500 hover:text-white transition">
                + Thêm Neuron
            </button>
        </div>
    </header>

    <div id="floating-date" class="date-floating-header uppercase tracking-widest text-blue-400">
        Tháng 01, 2026
    </div>

    <div class="photo-timeline-sidebar">
        <div class="time-mark">2026</div>
        <div class="time-mark">T12</div>
        <div class="time-mark">T11</div>
        <div class="time-mark">T10</div>
        <div class="time-mark">T09</div>
        <div class="time-mark">2025</div>
    </div>

    <div id="network-container"></div>

    <div id="addModal" class="fixed inset-0 z-[200] hidden flex items-center justify-center bg-black/60 backdrop-blur-sm">
        <div class="glass-ui p-8 rounded-[40px] w-96 border border-white/20">
            <h2 class="text-xl font-extrabold mb-6">Tạo Neuron Mới</h2>
            <div class="space-y-4">
                <input type="date" id="event-date" class="w-full bg-white/5 p-4 rounded-2xl outline-none">
                <input type="text" id="event-title" placeholder="Học sinh vi phạm, khen thưởng..." class="w-full bg-white/5 p-4 rounded-2xl outline-none">
                <button onclick="confirmNode()" class="w-full py-4 bg-blue-600 rounded-2xl font-bold hover:bg-blue-400 transition">Ghi nhận vào Timeline</button>
                <button onclick="closeModal()" class="w-full text-gray-500 text-xs uppercase font-bold">Hủy</button>
            </div>
        </div>
    </div>

    <script>
        // Cấu hình Vis.js Network
        let nodes = new vis.DataSet();
        let edges = new vis.DataSet();
        const container = document.getElementById('network-container');
        
        const options = {
            nodes: {
                shape: 'dot',
                size: 20,
                font: { color: '#ffffff', size: 12, face: 'Plus Jakarta Sans' },
                borderWidth: 0,
                shadow: { enabled: true, color: 'rgba(59, 130, 246, 0.5)', size: 10 }
            },
            edges: {
                color: { color: 'rgba(255,255,255,0.1)', highlight: '#3b82f6' },
                width: 1,
                smooth: { type: 'continuous' }
            },
            physics: {
                enabled: true,
                barnesHut: { gravitationalConstant: -2000, centralGravity: 0.1, springLength: 150 },
                stabilization: { iterations: 100 }
            }
        };

        const network = new vis.Network(container, { nodes, edges }, options);

        // Logic Timeline Google Photos
        const PIXELS_PER_MONTH = 1000; // Khoảng cách giữa các tháng
        const START_YEAR = 2025;
        const START_MONTH = 8; // Tháng 9 (0-indexed là 8)

        function openModal() { document.getElementById('addModal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('addModal').classList.add('hidden'); }

        function confirmNode() {
            const dateStr = document.getElementById('event-date').value;
            const title = document.getElementById('event-title').value;
            if(!dateStr || !title) return;

            const date = new Date(dateStr);
            const monthsDiff = (date.getFullYear() - START_YEAR) * 12 + (date.getMonth() - START_MONTH);
            
            // Tọa độ X dựa trên thời gian (Trục ngang như Google Photos)
            const xPos = monthsDiff * PIXELS_PER_DAY_CALC(date); 
            const yPos = (Math.random() - 0.5) * 400;

            const newNode = {
                id: Date.now(),
                label: title,
                x: xPos,
                y: yPos,
                group: date.getMonth(),
                color: { background: '#3b82f6', border: '#3b82f6' },
                font: { background: 'rgba(0,0,0,0.5)' }
            };

            nodes.add(newNode);
            
            // Tự động kết nối với Neuron gần nhất trong cùng tháng
            const sameGroup = nodes.get({ filter: n => n.group === date.getMonth() && n.id !== newNode.id });
            if(sameGroup.length > 0) {
                edges.add({ from: newNode.id, to: sameGroup[sameGroup.length - 1].id });
            }

            closeModal();
            network.moveTo({ position: {x: xPos, y: 0}, animation: true });
        }

        function PIXELS_PER_DAY_CALC(date) {
            const day = date.getDate();
            return day * 40; // Mỗi ngày cách nhau 40px
        }

        // Cập nhật Header ngày tháng khi cuộn (giống Google Photos)
        network.on("render", () => {
            const viewPos = network.getViewPosition();
            const totalDays = viewPos.x / 40;
            const currentDate = new Date(START_YEAR, START_MONTH);
            currentDate.setDate(currentDate.getDate() + totalDays);
            
            const monthNames = ["Tháng 01", "Tháng 02", "Tháng 03", "Tháng 04", "Tháng 05", "Tháng 06", "Tháng 07", "Tháng 08", "Tháng 09", "Tháng 10", "Tháng 11", "Tháng 12"];
            document.getElementById('floating-date').innerText = `${monthNames[currentDate.getMonth()]}, ${currentDate.getFullYear()}`;
        });

        // Dữ liệu mẫu khởi tạo
        nodes.add({ id: 1, label: "Lễ Khai Giảng", x: 0, y: 0, group: 8, color: '#ef4444' });
    </script>
</body>
</html>
